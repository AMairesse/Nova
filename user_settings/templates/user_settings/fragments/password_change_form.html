<!-- user_settings/templates/user_settings/fragments/password_change_form.html -->
{% load crispy_forms_tags i18n %}

<div id="password-change-section" class="card mb-4">
  <div class="card-header">
    <h5 class="mb-0">{% trans "Change Password" %}</h5>
  </div>
  <div class="card-body">
    {% if password_change_success %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <strong>{% trans "Password changed successfully!" %}</strong>
      <p class="mb-0">{% trans "Your password has been updated. You are still logged in and can continue using the application." %}</p>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}

    <form hx-post="{% url 'user_settings:general' %}?partial=1"
          hx-target="#password-change-section"
          hx-swap="innerHTML"
          method="post"
          novalidate>
      {% csrf_token %}
      {{ password_form.old_password|as_crispy_field }}
      {{ password_form.new_password1|as_crispy_field }}
      {{ password_form.new_password2|as_crispy_field }}
      <button type="submit" class="btn btn-primary">
        {% trans "Change Password" %}
      </button>
    </form>
  </div>
</div>