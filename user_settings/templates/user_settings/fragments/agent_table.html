<!-- user_settings/templates/user_settings/fragments/agent_table.html -->
{% load i18n %}

<div class="d-flex justify-content-between align-items-center mb-2">
  <h5 class="mb-0"></h5>
  {% if has_providers %}
    <a href="{% url 'user_settings:agent-add' %}?from=agents"
       class="btn btn-sm btn-primary">
      <i class="bi bi-plus-lg me-1"></i>{% trans "Add agent" %}
    </a>
  {% else %}
    <a href="#"
       class="btn btn-sm btn-primary disabled"
       aria-disabled="true"
       tabindex="-1">
      <i class="bi bi-plus-lg me-1"></i>{% trans "Add agent" %}
    </a>
  {% endif %}
</div>

<div class="table-responsive">
  <table class="table table-hover align-middle">
    <thead class="table-light">
      <tr><th>{% trans "Name" %}</th><th>{% trans "Provider" %}</th><th>{% trans "Agent as tool" %}</th><th class="text-end">{% trans "Actions" %}</th></tr>
    </thead>
    <tbody>
      {% for agent in agents %}
        <tr>
          <td>{{ agent.name }}</td>
          <td>{{ agent.llm_provider.name }}</td>
          <td>{{ agent.is_tool }}</td>
          <td class="text-end">
            <a href="{% url 'user_settings:agent-edit' agent.pk %}?from=agents"
               class="btn btn-sm btn-outline-primary me-1"><i class="bi bi-pencil"></i>{% trans "Edit" %}</a>
            {% if not agent.is_tool %}
              <a href="{% url 'user_settings:make_default_agent' agent.pk %}?from=agents"
                class="btn btn-sm btn-outline-secondary me-1{% if agent.id == default_agent_id %} disabled{% endif %}"
                {% if agent.id == default_agent_id %} aria-disabled="true" tabindex="-1"{% endif %}>
                <i class="bi bi-check2-circle"></i>
                {% trans "Make default" %}
              </a>
            {% endif %}
            <a href="{% url 'user_settings:agent-delete' agent.pk %}?from=agents"
               class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i>{% trans "Delete" %}</a>
          </td>
        </tr>
      {% empty %}
        {% if not has_providers %}
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            {% trans "You need to create an LLM provider first before you can create agents." %}
            <a href="{% url 'user_settings:dashboard' %}#pane-providers" class="alert-link">
              {% trans "Go to Providers" %}
            </a>
          </div>
        {% else %}
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            {% trans 'Click on "Add Agent" to create your first agent.' %}
          </div>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>
{% if is_paginated %}{% include "includes/pagination.html" %}{% endif %}
